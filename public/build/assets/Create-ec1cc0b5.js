import{q as S,r as c,j as e,P as C,_ as M,J as L}from"./app-8a2a51c8.js";import{M as O}from"./Modal-8b6796a7.js";import{I as P}from"./Input-4565f91c.js";import{L as _}from"./LinkButton-eaba230a.js";import{L as B}from"./LoadingButton-f631929b.js";import{S as y}from"./SelectSearch-c2539244.js";import{u as D}from"./useSwal-381cd456.js";import{h as E}from"./moment-a9aaa855.js";import{P as G}from"./PermohonanSelect-dd72d1d4.js";import{A}from"./AdminLayout-96d458bc.js";import{l as k}from"./lodash-aaf2e0ec.js";import{u as T}from"./usePrevious-2581348e.js";import"./transition-211cf23e.js";import"./use-flags-4a318b95.js";import"./dialog-43e39db9.js";import"./active-element-history-2e379daf.js";import"./description-9728843f.js";import"./bundle-mjs-11609d99.js";import"./index-dafd4053.js";import"./react-select.esm-5d079b1e.js";import"./emotion-element-c39617d8.browser.esm-49af1451.js";import"./form-72b18865.js";import"./NotificationDropdown-3e1ff87d.js";import"./ResponsiveNavLink-42824ad3.js";import"./MenuItem-d7945933.js";function z({prosespermohonans:t,statusprosesperms:h}){const{data:n,setData:x,errors:i,post:p,processing:f,reset:v}=S({prosespermohonan_id:"",prosespermohonan:null,statusprosesperm_id:"",statusprosesperm:null,catatan_statusprosesperm:"",_method:"POST"}),[b,g]=c.useState([]),[u,d]=c.useState(!1);function w(a){a.preventDefault(),p(route("admin.transaksi.prosespermohonans.statusprosesperms.store",n.prosespermohonan_id),{onSuccess:()=>{v("prosespermohonan_id","statusprosesperm_id","catatan_statusprosesperm"),d(!1)}})}const N=a=>{const o=a.map(m=>m.id),r=h.reduce((m,s,l)=>(m[l]=o.includes(s.value)?{value:s.value,label:s.label,isDisabled:!0}:{value:s.value,label:s.label,isDisabled:!1},m),[]);g(r),d(!0)},j=(a,o)=>{C.delete(route("admin.transaksi.prosespermohonans.statusprosesperms.destroy",[a,o]),{only:["prosespermohonans"]})};return e.jsxs("div",{className:"w-full mt-4 flex flex-col",children:[e.jsx("ul",{className:"list-none container-snap max-h-56 overflow-x-hidden",children:e.jsxs("li",{className:"flex relative flex-row w-full items-center rounded-t-md text-sm border justify-start bg-lightBlue-600 border-blueGray-400 px-2 py-2 gap-1 text-lightBlue-50 font-bold",children:[e.jsx("div",{className:"w-[5%]",children:"No"}),e.jsx("div",{className:"w-[15%]",children:"Tanggal"}),e.jsx("div",{className:"w-[40%] md:w-[25%]",children:"Nama Proses"}),e.jsx("div",{className:"hidden md:block w-[25%]",children:"Catatan"}),e.jsx("div",{className:"w-[15%]",children:"User"}),e.jsx("div",{className:"flex-shrink-0",children:"Menu"})]})}),e.jsx("ul",{className:"list-none container-snap max-h-80 overflow-x-hidden rounded-b-md shadow-md",children:t&&t.map((a,o)=>e.jsxs("li",{className:"w-full flex flex-col overflow-hidden bg-lightBlue-200",children:[e.jsxs("div",{className:"flex w-full text-sm px-2 py-0 items-center justify-start gap-1 font-semibold text-lightBlue-600 border-t-2 border-lightBlue-400",children:[e.jsx("div",{className:"w-[5%]",children:o+1}),e.jsx("div",{className:"w-[15%]",children:a.tgl_proses}),e.jsx("div",{className:"w-[40%] md:w-[25%]",children:a.itemprosesperm.nama_itemprosesperm}),e.jsx("div",{className:"hidden md:block md:w-[25%]",children:a.catatan_prosesperm}),e.jsx("div",{className:"w-[15%]",children:a.user.name}),e.jsx("div",{className:"flex-shrink-0 flex justify-start items-center gap-2",children:e.jsx("button",{onClick:r=>{x("prosespermohonan_id",a.id),N(a.statusprosesperms)},className:"text-lightBlue-500 background-transparent text-xl font-bold uppercase px-0 py-0 outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"button",children:e.jsx("i",{className:"fa fa-plus-circle","aria-hidden":"true"})})})]}),a.statusprosesperms.length?e.jsx("div",{className:"w-full flex flex-col text-sm border-t-2 border-lightBlue-400",children:e.jsx("ul",{className:"list-none w-full px-6 bg-lightBlue-100  text-lightBlue-700",children:a.statusprosesperms.map((r,m)=>e.jsx("li",{className:"w-full",children:e.jsxs("ol",{className:"flex flex-row w-full items-center text-xs gap-1",children:[e.jsx("li",{children:e.jsx("img",{src:r.image_statusprosesperm,className:"h-5 w-auto","aria-hidden":!0,alt:""})}),e.jsx("li",{children:E(r.pivot.created_at).format("DD MMM YYYY")}),e.jsx("li",{className:"font-semibold",children:r.nama_statusprosesperm}),e.jsx("li",{children:r.pivot.catatan_statusprosesperm?"("+r.pivot.catatan_statusprosesperm+")":""}),e.jsxs("li",{children:["oleh ",e.jsx("span",{className:"font-semibold",children:r.user.name})]}),e.jsx("li",{children:e.jsx("button",{onClick:s=>D.confirm({title:"Hapus Data",text:"apakah akan menghapus?"}).then(l=>{l.isConfirmed&&j(a.id,r.id)}),className:"text-lightBlue-400 background-transparent font-bold px-3 py-0 text-sm outline-none focus:outline-none hover:text-lightBlue-600 hover:scale-105 mr-1 mb-1 mt-1 ease-linear transition-all duration-150",type:"button",children:e.jsx("i",{className:"fa fa-minus-circle","aria-hidden":"true"})})})]})},m))})}):null]},a.id))}),e.jsx(O,{show:u,maxWidth:"md",closeable:!1,onClose:()=>alert("modal close"),children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:w,children:[e.jsx(y,{name:"itemprosesperm_id",label:"Status Proses",value:n.statusprosesperm,options:b,onChange:a=>x({...n,statusprosesperm_id:a?a.value:"",statusprosesperm:a||{}}),errors:i.statusprosesperm_id}),e.jsx(P,{name:"catatan_statusprosesperm",label:"Catatan",errors:i.catatan_statusprosesperm,value:n.catatan_statusprosesperm,onChange:a=>x("catatan_statusprosesperm",a.target.value)}),e.jsxs("div",{className:"mt-4 w-full flex justify-between items-center",children:[e.jsx(B,{theme:"black",loading:f,type:"submit",children:e.jsx("span",{children:"Simpan"})}),e.jsx(_,{href:"#",theme:"blue",onClick:a=>{a.preventDefault(),d(!1)},children:e.jsx("span",{children:"Close"})})]})]})})})]})}const R=c.lazy(()=>M(()=>import("./CardPermohonan-1a857580.js"),["assets/CardPermohonan-1a857580.js","assets/app-8a2a51c8.js","assets/app-9eb761df.css"])),ce=()=>{const{transpermohonan:t,itemprosesperms:h,prosespermohonans:n,statusprosesperms:x}=L().props,{data:i,setData:p,errors:f,post:v,processing:b,reset:g}=S({transpermohonan_id:t?t.id:"",permohonan:null,itemprosesperm_id:"",itemprosesperm:void 0,catatan_prosesperm:"",active:!0,_method:"POST"}),[u,d]=c.useState(!1);function w(s){s.preventDefault(),D.confirm({title:"Simpan Data",text:"akan menyimpan perubahan?"}).then(l=>{l.isConfirmed&&v(route("admin.transaksi.prosespermohonans.store"),{onSuccess:()=>{g("itemprosesperm","itemprosesperm_id","catatan_prosesperm","active"),d(!1)}})})}const N=s=>{s&&(p({...i,transpermohonan_id:s.transpermohonan.id,permohonan:s}),o(l=>({...l,transpermohonan_id:s.transpermohonan.id})))},j=new URLSearchParams(window.location.search),[a,o]=c.useState({transpermohonan_id:j.get("transpermohonan_id"),itemprosesperm_id:j.get("itemprosesperm_id")}),r=T(a),m=h.find(s=>s.value===a.itemprosesperm_id);return c.useEffect(()=>{if(r){const s=Object.keys(k.pickBy(a)).length?k.pickBy(a):{};C.get(route(route().current()?route().current()+"":""),s,{replace:!0,preserveState:!0})}},[a]),e.jsxs(A,{children:[u?e.jsx("div",{className:"z-20 absolute h-full w-full left-0"}):null,e.jsx("div",{className:"flex content-center items-center justify-center h-full",children:e.jsx("div",{className:"w-full lg:w-2/3 px-4",children:e.jsxs("div",{className:"relative flex flex-col min-w-0 break-words w-full mb-2 shadow-lg shadow-slate-400 rounded-lg bg-blueGray-200 border-0",children:[e.jsx("div",{className:"rounded-t mt-2 px-4",children:e.jsx("div",{className:"text-center",children:e.jsx("h6",{className:"text-blueGray-500 text-lg font-bold",children:"PROSES PERMOHONAN"})})}),e.jsxs("div",{className:"flex-auto p-4",children:[e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center w-full gap-1",children:[e.jsx(G,{className:`w-full ${u?"z-10":""}`,value:t==null?void 0:t.permohonan,onValueChange:N,errors:f.transpermohonan_id}),e.jsx(y,{className:"z-40 mb-0 w-1/3 text-sm",options:h,value:m,onChange:s=>o(l=>({...l,itemprosesperm_id:s.value}))})]}),e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex items-center justify-center h-52 m-auto",children:"Loading..."})}),children:e.jsx("div",{children:t&&t.permohonan?e.jsx(R,{permohonan:t.permohonan}):null})}),t&&t.permohonan?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"z-30 flex justify-end items-center bg-blueGray-400 py-2 px-1 rounded-md shadow-md mb-0 relative",children:u?e.jsx(e.Fragment,{children:e.jsx(_,{href:"#",theme:"black",onClick:s=>{s.preventDefault(),d(!1)},children:e.jsx("span",{children:"Tutup"})})}):e.jsx(_,{href:"#",theme:"black",onClick:s=>{s.preventDefault(),d(!0)},children:e.jsx("span",{children:"Tambah"})})}),e.jsxs("div",{className:`z-20 flex flex-wrap lg:items-start transition-all transform ease-linear duration-150 origin-top m-auto mt-2 absolute shadow-slate-500 shadow-lg bg-blueGray-300 w-[95%] rounded-b-md ring-blueGray-400 ring-2 p-2 ${u?"translate-y-100 opacity-100":"-translate-y-full opacity-0 "}`,children:[e.jsx("div",{className:"w-full lg:w-2/5 pr-2",children:e.jsx(y,{name:"itemprosesperm_id",label:"Nama Proses",value:i.itemprosesperm,options:h,onChange:s=>p({...i,itemprosesperm_id:s?s.value:"",itemprosesperm:s||{}}),errors:f.itemprosesperm_id})}),e.jsx("div",{className:"w-full lg:w-2/5 pr-2",children:e.jsx(P,{name:"catatan_prosesperm",autoComplete:"off",multiple:!0,label:"Catatan",errors:f.catatan_prosesperm,value:i.catatan_prosesperm,type:"text",onChange:s=>p("catatan_prosesperm",s.target.value)})}),e.jsx("div",{className:"relative h-full lg:mt-8",children:e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{id:"customCheckLogin",type:"checkbox",className:"form-checkbox border-0 rounded text-blueGray-700 ml-1 w-5 h-5 ease-linear transition-all duration-150",checked:i.active,onChange:s=>p("active",s.target.checked)}),e.jsx("span",{className:"ml-2 text-sm font-semibold text-blueGray-600",children:"Active"})]})}),e.jsx(B,{theme:"black",loading:b,type:"submit",children:e.jsx("span",{children:"Simpan"})})]})]}):null]}),n&&n.length>0?e.jsx(z,{prosespermohonans:n,statusprosesperms:x}):null]})]})})})]})};export{ce as default};
